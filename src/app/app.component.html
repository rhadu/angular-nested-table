<div class="container">
  <table class="table table-bordered table-hover table-responsive">
    <thead>
      <tr>
        <th>
          <input type="checkbox" (change)="selectAllRows($event)" />
        </th>
        <th>Name</th>
        <th>Type</th>
        <th>Email</th>
        <th>Phone Number</th>
        <th>Company Name</th>
      </tr>
    </thead>
    <tbody>
      <ng-container *ngFor="let row of data;">
        <tr
          [ngClass]="{ 'selected-row': row.isSelected }"
          (mouseenter)="row.hover = true"
          (mouseleave)="row.hover = false"
        >
          <td>
            <input
              type="checkbox"
              [(ngModel)]="row.isSelected"
            />
          </td>
          <td>
            <i
              *ngIf="row.children?.length"
              class="bi-arrow-right-short icon-wrapper"
              [ngClass]="{ expanded: row.expanded }"
              (click)="row.expanded = !row.expanded"
            ></i>
            {{ row.name }} z
          </td>
          <td>{{ row.type }}</td>
          <td>{{ row.email }}</td>
          <td>{{ row.phoneNo }}</td>
          <td>{{ row.companyName }}</td>
        </tr>
        <ng-container *ngIf="row.expanded">
          <ng-container
            *ngTemplateOutlet="nestedRow; context: { $implicit: row.children }"
          ></ng-container>
        </ng-container>
      </ng-container>
    </tbody>
  </table>
</div>

<ng-template #nestedRow let-rows>
  <ng-container *ngFor="let row of rows">
    <tr
      [ngClass]="{ 'selected-row': row.isSelected }"
      (mouseenter)="row.hover = true"
      (mouseleave)="row.hover = false"
    >
      <td>
        <input
          type="checkbox"
          [(ngModel)]="row.isSelected"
        />
      </td>
      <td>
        <i
          *ngIf="row.children?.length"
          class="bi-arrow-right-short icon-wrapper"
          [ngClass]="{ expanded: row.expanded }"
          (click)="row.expanded = !row.expanded"
        ></i>
        {{ row.name }}
      </td>
      <td>{{ row.type }}</td>
      <td>{{ row.email }}</td>
      <td>{{ row.phoneNumber }}</td>
      <td>{{ row.companyName }}</td>
    </tr>
    <ng-container *ngIf="row.expanded">
      <ng-container
        *ngTemplateOutlet="nestedRow; context: { $implicit: row.children }"
      ></ng-container>
    </ng-container>
  </ng-container>
</ng-template>
